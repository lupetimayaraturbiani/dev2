-- CRIAR BANCO DE DADOS 
CREATE DATABASE Gufi_Tarde;


USE Biblioteca_Tarde;
DROP DATABASE Gufi_Tarde;

USE Gufi_Tarde;



 ALTER TABLE  Usuario
 ALTER COLUMN DataNascimento DATETIME2;

-- CRIAR TABELAS DO BANCO DE DADOS
CREATE TABLE TipoUsuario (
IdTipoUsuario		INT PRIMARY KEY IDENTITY,
TituloTipoUsuario	VARCHAR (255) NOT NULL UNIQUE
);

CREATE TABLE TipoEvento (
IdTipoEvento		INT PRIMARY KEY IDENTITY,
TituloTipoEvento	VARCHAR (255) NOT NULL UNIQUE
);

CREATE TABLE Instituicao (
IdInstituicao		INT PRIMARY KEY IDENTITY,
CNPJ				CHAR (14) NOT NULL UNIQUE,
Nome				VARCHAR (255) NOT NULL UNIQUE,
Endereco			VARCHAR (255) not null unique
);

CREATE TABLE Usuario (
IdUsuario			INT PRIMARY KEY IDENTITY,
NomeUsuario			VARCHAR (255) NOT NULL,
Email				VARCHAR (255) NOT NULL,
Senha				VARCHAR (255) NOT NULL,
Genero				VARCHAR (255) NOT NULL,
DataNascimento		VARCHAR (255) NOT NULL, 
IdTipoUsuario		INT FOREIGN KEY REFERENCES TipoUsuario (IdTipoUsuario)
);

CREATE TABLE Evento (
IdEvento			INT PRIMARY KEY IDENTITY,
NomeEvento			VARCHAR (255) NOT NULL,
DataEvento			DATETIME2 NOT NULL,
Descricao			VARCHAR (255) NOT NULL,
AcessoLivre			BIT DEFAULT (1) NOT NULL,
IdInstituicao		INT FOREIGN KEY REFERENCES Instituicao (IdInstituicao),
IdTipoEvento		INT FOREIGN KEY REFERENCES TipoEvento (IdTipoEvento)
);

CREATE TABLE Presenca (
IdPresenca			INT PRIMARY KEY IDENTITY,
IdUsuario			INT FOREIGN KEY REFERENCES Usuario (IdUsuario),
IdEvento			INT FOREIGN KEY REFERENCES Evento (IdEvento),
Situacao			VARCHAR (255) NOT NULL
);
